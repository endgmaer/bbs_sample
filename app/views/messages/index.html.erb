<h1>簡易掲示板</h1>

<% if @message.errors.present? %>
  <% @message.errors.full_messages.each do |err| %>
    <p style="color: red"><%= err %></p>
    <br>
  <% end %>
  <br>
<% end %>

<%= form_for(@message) do |f| %>
  <p>投稿</p>
  <div>
    <%= f.text_field :title, size: '25', placeholder: 'お名前を入力してください' %>
  </div>
  <div>
    <%= f.password_field :password, size: '25', placeholder: '削除用パスワードを入力' %>
  </div>
  <div>
    <%= f.text_area :body, size: '30x7', placeholder: '投稿内容を入力してください' %>
  </div>
  <%= f.submit '投稿する' %>
<% end %>
<hr>

<div>
  <tr>
    <th><%= link_to "新着順", sort: :lreleased_at %></th>
    <th><%= link_to "投稿者名順", sort: :name %></th>
    <th><%= link_to "古い順", sort: :released_at %></th>
  </tr>
</div>

<div>
  <%=
    select_tag 'sort_order',
               options_for_select([["新着順", "asc"], ["名前順", "name"], ["古い順", "desc"]]),
               { class: 'CreateMessages' }
  %>

  <%= search_form_for @search do |f| %>
    <%= f.search_field :body_cont, placeholder: '検索ワードを入力' %>
    <%= f.submit %>
  <% end %>
</div>

<div>
  <%= paginate @messages %>
</div>

<%= form_for @message do |f| %>
  <div>
    <% @messages.each do |msg| %>
      <%= msg.id %> : <%= msg.title %> : <%= msg.created_at.to_s(:datetime_jp) %>
      <br>
      <pre>
      <%= msg.body %>
        <%= link_to '削除', message_path(msg), method: :delete, data: { confirm: "削除してもよろしいですか？" } %>
    </pre>
    <% end %>
  </div>
<% end %>

<div>
  <%= paginate @messages %>
</div>
